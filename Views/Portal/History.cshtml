@model IEnumerable<mytimmings.Models.Portal.CalendarRecord>

@{
    ViewBag.Title = "History";
}


<link href="~/fullcalendar/lib/main.css" rel="stylesheet" />
<script src="~/fullcalendar/lib/main.js"></script>
@Styles.Render("~/Portal/css")


<style>
    #external-events {
        position: absolute;
        margin-top: 60px;
        z-index: 2;
        width: 150px;
        padding: 0 10px;
        border: 1px solid #ccc;
        background: #eee;
    }

        #external-events .fc-event {
            cursor: move;
            margin: 3px 0;
        }

    #calendar-container {
        position: relative;
        z-index: 1;
        margin-left: 200px;
    }
</style>


<div class="main-body-container w3-main">
    @*<div class="page-title">
        <h1>History</h1>
    </div>*@
    <div class="main-wrapper" style="margin: 0 auto">

        <div class="calendar-container">
            <div id="calendar" style="margin: 15px">

            </div>
        </div>
    </div>


</div>


<script>


    document.addEventListener('DOMContentLoaded', function () {
        var Calendar = FullCalendar.Calendar;
        var calendarEl = document.getElementById('calendar');
        var CalendarItems = [];
        var records = @Html.Raw(Json.Encode(Model));

        for (var i = 0; i < records.length; i++) {
            var endDate = ""
            //if (records[i].End = null) {
            //    var timeStamp = new Date();
            //    endDate = timeStamp.getFullYear() + "-" + (timeStamp.getMonth() + 1) + "-" + timeStamp.getDate() + "T" + timeStamp.getHours() + ":" + timeStamp.getMinutes() + timeStamp.getSeconds();

            //}

            CalendarItems.push({
                title: records[i].Title,
                start: records[i].Start,
                end: records[i].End,
                allDay: records[i].AllDay,
                overlap: false,
                color: records[i].Color,
                display: "block"

            })
        }
        console.log(CalendarItems)
        console.log(records);
        // initialize the calendar
        // -----------------------------------------------------------------

        var calendar = new Calendar(calendarEl, {
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            slotDuration: '00:10',
            //nowIndicator: true,
            navLinks: true,
            defaultTimedEventDuration: "00:10",
            businessHours: true,
            businessHours: {
                // days of week. an array of zero-based day of week integers (0=Sunday)
                daysOfWeek: [1, 2, 3, 4, 5], // Monday - Friday

                startTime: '10:00', // a start time (10am in this example)
                endTime: '18:00', // an end time (6pm in this example)
            },

            //events: [
            //    {
            //        title: "Busy",
            //        start: '2021-02-27T12:00:00',
            //        end: '2021-02-27T13:00:00',
            //        allDay: false,
            //        overlap: false

            //    },

            //    {
            //        title: "Break",
            //        start: '2021-02-27T13:00:00',
            //        end: '2021-02-27T15:00:00',
            //        allDay: false,
            //        color: 'red',
            //    }

            //]

            events: CalendarItems
        });

        calendar.render();
    });
</script>